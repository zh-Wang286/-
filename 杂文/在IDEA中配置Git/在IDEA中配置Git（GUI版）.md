在IDEA中配置Git（GUI版）

> 本文整理自尚硅谷_韩总

[TOC]

# 1.安装Git核心程序

根据自己的电脑操作系统从Git 官网 [https://git-scm.com/]下载对应的Git核心。

详细安装流程可以看这两篇教程：

- 知乎|[Windows系统Git安装教程（详解Git安装过程）](https://zhuanlan.zhihu.com/p/242540359)2020-09-14
- 知乎|[Git安装步骤](https://zhuanlan.zhihu.com/p/406808554)2021-09-04
  
安装成功后，在桌面或资源管理器任意位置右键，会出现Git命令

![image-20220120115423069](image-20220120115423069.png)

选择Bash，输入`git --version`查看版本号

```bash
Wang@DESKTOP-JSN6X8M MINGW64 ~/Desktop
$ git --version
git version 2.34.1.windows.1
```

# 2.全局配置

## 2.1配置Git核心

打开IDEA，`File-Settings-Version Control-Git`。若是安装在默认目录，IDEA能自动找到`git.exe`；若安装在自定目录，找到安装目录`~\bin\`，选择`git.exe`文件。

配置完成后，可以点击Test测试，若配置成功，则会显示Git版本号。

![image-20220120104938572](image-20220120104938572.png)

配置GitHub账户。

![image-20220120105019176](image-20220120105019176.png)

# 3.创建本地库

## 3.1 新建本地库

创建一个Empty Project

![image-20220120104208790](image-20220120104208790.png)

在空工程（Empty Project）中添加模块（Modules）  

![image-20220120104454657](image-20220120104454657.png)

创建本地库

工具栏`VCS-Create Git Repository`（早起IDEA版本可能在`VCS-Import into Version Control-Create Git Repository`）

![image-20220120105203338](image-20220120105203338.png)

选择当前模块的父目录

![image-20220120105316930](image-20220120105316930.png)

点击OK本地库创建成功，工具栏出现Git相关操作工具。同时，在本地文件管理器查看父目录时，会出现`.git`隐藏文件夹。

![image-20220120105949575](image-20220120105949575.png)

![image-20220120105516416](image-20220120105516416.png)

## 3.2添加到暂存区

在HelloGit目录下创建文件，创建了新文件之后会提示是否添加到暂存区。

![image-20220120110212118](image-20220120110212118.png)

如果点击了 Cancel，此时文件只存在于工作区（后面可手动添加到暂存区），文件的状态如下图：

![image-20220120110259481](image-20220120110259481.png)

设置忽略文件。忽略文件即不会被添加到暂存区的文件。在模块上右键`Git-Add to .gitignore`，会出现两种方式。

![image-20220120110618914](image-20220120110618914.png)

方式二只需要修改.git/info 目录下的 exclude 文件即可，不需要创建新的文件，建议大家选择这种方式。

![image-20220120111014785](image-20220120111014785.png)

被忽略的文件变成了灰色（有时候可能需要刷新模块或重启 Idea 才能看到）

![image-20220120113337465](image-20220120113337465.png)

在模块上右键将文件添加到暂存区

![image-20220120113409275](image-20220120113409275.png)

添加到暂存区之后文件的状态如下图：

![image-20220120113433024](image-20220120113433024.png)

## 3.3添加到本地库

在模块上右键或点击工具栏（√ Commit）将文件添加到本地库

![image-20220120113508878](image-20220120113508878.png)

添加注释内容后提交

![image-20220120113606429](image-20220120113606429.png)

提交到本地库之后文件的状态如下图：

![image-20220120113643029](image-20220120113643029.png)

# 4.版本控制

## 4.1 切换版本

改动文件内容并多次上传后，在模块上右键或者点击工具栏查看历史

![image-20220120114043750](image-20220120114043750.png)

选择要切换的版本

![image-20220120114100759](image-20220120114100759.png)

右键-`Copy Revision Number`

![image-20220120114139899](image-20220120114139899.png)

在模块上右键-`Git-Reset HEAD`（部分版本是`Git-Repository-Reset HEAD`）

![image-20220120114449534](image-20220120114449534.png)

选择 Hard 并粘贴版本号

![image-20220120114507082](image-20220120114507082.png)

版本切换成功

![image-20220120114522057](image-20220120114522057.png)

注意：从Master（最新版本）切换回旧版后，如果再想切回Master，只能通过命令行控制切回。

## 4.2创建分支与合并分支

在模块上右键-`Git-Branches`（部分版本`Git-Repository-Branches`），点击`New Branch`，给新分支命名

![image-20220120115919575](image-20220120115919575.png)

点击`Create`后自动切换到新分支。在新分支添加新的代码并提交

![image-20220120120013011](image-20220120120013011.png)

在模块上右键`Git-Branches-master-checkout`，切换到主干（Master），再在模块上右键`Git-Merge`（有些版本`Git-Repository-Merge Changes`）

![image-20220120120320231](image-20220120120320231.png)

选择要合并的分支

![image-20220120120416620](image-20220120120416620.png)

合并成功

![image-20220120120435771](image-20220120120435771.png)

## 4.3解决冲突

> 例如：让主干和分支在同一个位置添加一行代码

主干添加内容，并添加到暂存区和本地库；分支添加内容，并添加到暂存区和本地库

![image-20220120120723650](image-20220120120723650.png)

在主干合并分支内容，出现冲突

![image-20220120120756699](image-20220120120756699.png)

选择合并（Merge），出现处理窗口

![image-20220120120828002](image-20220120120828002.png)

处理之后，点击 Apply 应用

![image-20220120120904339](image-20220120120904339.png)

# 5.上传本地库到GitHub与更新本地库

## 5.1在GitHub新建仓库

在 GitHub 网站上创建仓库

![image-20220120121149852](image-20220120121149852.png)

![image-20220120121211192](image-20220120121211192.png)

复制仓库地址

![image-20220120121248367](image-20220120121248367.png)

在 Idea 中的模块上右键`Git-Push`（有些版本`Git-Repository-Push`）

![image-20220120121415249](image-20220120121415249.png)

设置远程地址别名

![image-20220120121429100](image-20220120121429100.png)

点击 Push 推送到 GitHub 仓库

![image-20220120121444038](image-20220120121444038.png)

注意：由于网络原因，可能会出现push失败，需要多次提交。

## 5.2 上传本地库

> 正常情况下是合作伙伴上传新的代码到 GitHub，如果此时本地库不更新将无法上传，为了简单起见，我们直接在 GitHub 上在线修改文件。

在 GitHub 上在线添加一个文件

![image-20220120121620062](image-20220120121620062.png)

IDEA 中的本地库也修改文件、添加到暂存库、添加到本地库，然后上传，发现上传被拒绝。

![image-20220120121649063](image-20220120121649063.png)

此时点击 Merge 或 Rebase 都可以实现本地库与远程 GitHub 的同步，也可以点击 Cancel 之后pull到本地库。

![image-20220120121734168](image-20220120121734168.png)

点击 Pull 将 GitHub 上最新的代码合并都本地库

![image-20220120121759081](image-20220120121759081.png)

点击 Pull 之后更新本地库成功

![image-20220120121816592](image-20220120121816592.png)

# 6.克隆项目

点击 IDEA 中的 `Git-Clone` 选项（有些版本`VCS-Git-Clone`）

![image-20220120121853384](image-20220120121853384.png)

输入 GitHub 中的仓库地址并指定项目的存放路径

![image-20220120122212915](image-20220120122212915.png)

提示是否为克隆的项目创建一个新工程，点击 Yes 弹出导入工程的提示框，需要为新工程配置一下 JDK、导入 Module。

